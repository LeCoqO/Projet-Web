<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>

</body>


<script>
  var json = {
    "nom": "azd",
    "taille": "M",
    "nbr_ingr_principaux": 3,
    "nbr_ingr_secondaires": 3,
    "prix": "10",
    "img": "logo_3.png",
    "ingr_principaux": {
      "ingr_1": "Pain Sesame",
      "ingr_1_qty": "4",
      "ingr_2": "Boeuf",
      "ingr_2_qty": "7",
      "ingr_3": "Poulet",
      "ingr_3_qty": "6",
      "ingr_4": "Salade",
      "ingr_4_qty": "56",
      "ingr_5": "",
      "ingr_5_qty": ""
    },
    "ingr_secondaires": {
      "ingr_1": "Sauce Algérienne",
      "ingr_1_qty": "6",
      "ingr_2": "Sauce Burger",
      "ingr_2_qty": "65",
      "ingr_3": "Sauce Moustache",
      "ingr_3_qty": "7",
      "ingr_4": "",
      "ingr_4_qty": "",
      "ingr_5": "",
      "ingr_5_qty": "",
      "ingr_6": "",
      "ingr_6_qty": ""
    },
    "incontournable": true,
    "nombreOptionMax": "3"
  }
  var prodId = 4;
  for (let i = 0; i < json['nbr_ingr_secondaires']; i++) {
    var ingId = getBddIdOfIng(json['ingr_secondaires']['ingr_' + (i + 1)]);

    $.ajax({
      url: 'ajax_Bdd.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'update', //fonction à executer
        requete: "INSERT INTO `prod_ingr` (`IdIng`, `IdProd`, `Quant`)" +
          "VALUES ('10', '3', '3'), ('12', '13', '54');",
      },
      success: function (data) {
        //location.reload();
        //console.log(data)
      },
      error: function (dataSQL, statut) {
        alert("error sqlConnect.js : " + dataSQL.erreur);
      }
    });
  }

  function getBddIdOfIng(name) {
    $.ajax({
      url: 'ajax_Bdd.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'requete', //fonction à executer
        requete: "SELECT IdIng FROM ingredient WHERE NomIng LIKE '" + name + "'",
      },
      success: function (data) {
        console.log(data)
        var resultats = JSON.parse(data);
        console.log(resultats);
        return resultats
      },
      error: function (dataSQL, statut) {
        alert("error sqlConnect.js : " + dataSQL.erreur);
      }
    });
  }
  function getBddIdOfProd(name) {
    $.ajax({
      url: 'ajax_Bdd.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'requete', //fonction à executer
        requete: "SELECT IdProd FROM produit WHERE NomProd LIKE '" + name + "'",
      },
      success: function (data) {
        //console.log(data)
        var resultats = JSON.parse(data);
        console.log(resultats);
        return resultats
      },
      error: function (dataSQL, statut) {
        alert("error sqlConnect.js : " + dataSQL.erreur);
      }
    });
  }
</script>

</html>