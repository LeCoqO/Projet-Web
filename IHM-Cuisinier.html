<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IHM-Cuisinier</title>
  <link rel="stylesheet" href="style.css" />
  <header>
    <div class="sidebar" id="mySidebar">
      <button class="bar-item button" onclick="sidebar_close()">
        Close &times;
      </button>
      <a href="commande.php" class="bar-item button">Commande</a><br />
      <a href="recette.php" class="bar-item button">Link 2</a><br />
      <a href="#" class="bar-item button">Link 3</a>
    </div>
    <button class="button left hide-large" onclick="sidebar_open()">
      &#9776;
    </button>
    <div class="rigth logo">
      <img src="Image/logo.png" class="text-center" alt="" width="100px" height="100px" />
    </div>
    <div>
      <br /><br /><br /><br /><br />
      <h1>Hom'Burger</h1>
      <label id="TitreDeLaPage" class="gras text-center">IHM-Cuisinier : Préparation des commandes
      </label>
    </div>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Shadows+Into+Light&display=swap" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  </header>
  <script>
    function sidebar_open() {
      document.getElementById("mySidebar").style.display = "block";
    }

    function sidebar_close() {
      document.getElementById("mySidebar").style.display = "none";
    }
    function OnOff(id) {
      if (document.getElementById(id).style.visibility == "visible")
        document.getElementById(id).style.visibility = "hidden";
      else document.getElementById(id).style.visibility = "visible";
    }


  </script>
  <!-- Select Numéro de commande -->
  <script text/javascript>
    $.ajax({
      url: 'requette.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'select', //fonction à executer
        requete: 'SELECT NumCom FROM commande',
      },
      success: function (data) {

        console.log(data);

        let resultats = JSON.parse(data);

        let selectNumCom = document.createElement('select');

        document.getElementById('h3Cuisine').appendChild(selectNumCom);

        for (i = 0; i < resultats.length; i++) {
          var randomOption = document.createElement('option');
          randomOption.innerHTML = resultats[i]['NumCom'];
          randomOption.value = resultats[i]['NumCom'];

          selectNumCom.appendChild(randomOption);
        };

      },
      error: function (dataSQL, statut) {
        alert("error sqlConnect.js : " + dataSQL.erreur);
      }
    });

  </script>
  <!-- Select Heure disponibilité -->
  <script text/javascript>
    $.ajax({
      url: 'requette.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'select', //fonction à executer
        requete: 'SELECT HeureDispo FROM commande WHERE NumCom',
      },
      success: function (data) {

        console.log(data);

        let resultats = JSON.parse(data);

        let selectHeure = document.createElement('select');

        document.getElementById('reqHeure').appendChild(selectHeure);

        for (i = 0; i < resultats.length; i++) {
          var randomOption = document.createElement('option');
          randomOption.innerHTML = resultats[i]['HeureDispo'];
          randomOption.value = resultats[i]['HeureDispo'];

          selectHeure.appendChild(randomOption);
        };

      },
      error: function (dataSQL, statut) {
        alert("error sqlConnect.js : " + dataSQL.erreur);
      }
    });
  </script>
  <!-- Select Nb burger -->
  <script text/javascript>
    $.ajax({
      url: 'requette.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'select', //fonction à executer
        requete: 'SELECT SUM(Quant) FROM com_det WHERE NumCom',
      },
      success: function (data) {

        console.log(data);

        let resultats = JSON.parse(data);

        let selectNbBurger = document.createElement('select');

        document.getElementById('nombreBurger').appendChild(selectNbBurger);

        for (i = 0; i < resultats.length; i++) {
          var randomOption = document.createElement('option');
          randomOption.innerHTML = resultats[i]['SUM(Quant)'];
          randomOption.value = resultats[i]['SUM(Quant)'];

          selectNbBurger.appendChild(randomOption);
        };

      },
      error: function (dataSQL, statut) {
        alert("error sqlConnect.js : " + dataSQL.erreur);
      }
    });
  </script>
  <!-- Select liste ingrédients -->
  <script text/javascript>
    $.ajax({
      url: 'requette.php', //toujours la même page qui est appelée
      type: 'POST',
      data: {
        fonction: 'select', //fonction à executer
        requete: 'SELECT * FROM `produit` WHERE IdProd IN(SELECT IdProd FROM `detail` WHERE Num_OF IN(SELECT Num_OF FROM `com_det` WHERE NumCom in(SELECT NumCom FROM `Commande` WHERE EtatCde LIKE "A Preparer"))) ',
      },
    success: function (data) {

      console.log(data);

      let resultats = JSON.parse(data);

      let selectListe = document.createElement('select');

      document.getElementById('listeIng').appendChild(selectListe);

      for (i = 0; i < resultats.length; i++) {
        var randomOption = document.createElement('option');

        let array = ['IngBase1','IngBase2','IngBase3','IngBase4','IngOpt1','IngOpt2','IngOpt3','IngOpt4'];
        let tabF;
        array.forEach ;{
          
          if (['IngBase1'] != null) {
            tabF+=['IngBase1'];
          }
          if (['IngBase2'] != null) {
            tabF+=['IngBase2'];
          }
          if (['IngBase3'] != null) {
            tabF+=['IngBase3'];
          }
          if (['IngBase4'] != null) {
            tabF+=['IngBase4'];
          }
          if (['IngOpt1'] != null) {
            tabF+=['IngOpt1'];
          }
          if (['IngOpt2'] != null) {
            tabF+=['IngOpt2'];
          }
          if (['IngOpt3'] != null) {
            tabF+=['IngOpt3'];
          }
          if (['IngOpt4'] != null) {
            tabF+=['IngOpt4'];
          }
          for(j = 0; j < tabF; j++) {
            randomOption.innerHTML = tabF[i];
            randomOption.value = tabF[i];
          }
        } 
        selectListe.appendChild(randomOption);
      };

    },
    error: function (dataSQL, statut) {
      alert("error sqlConnect.js : " + dataSQL.erreur);
    }
    });
  </script>
</head>

<body id="acceuilCuisinier">
  <section id="sectionCuisine">
    <article class="articleCommande">
      <h3 id="h3Cuisine">Commande N° : </h3>
      <div class="nbBurger">
        <p id="nombreBurger">Nombre de burgers : </p>
      </div>
      <div class="heurePrepa">
        <p id="reqHeure">Doit être prête pour : </p>
      </div>
      <br /><br /><br /><br />
      <div class="burgerAFaire">
        <div class="apercuCmd">
          <img class="imgCuisine" src="Image/chinoisBurger.jpg">
          <p>: 2 burgers</p>
        </div>
        <div class="listeCuisine">
          <input type="button" value="Liste des ingrédients" class="btnListeIngredients" />
          <span id="listeIng"></span>
        </div>
      </div>
      <br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      <input type="button" value="A préparer" class="aPrepa" />
      <input type="button" value="Commande terminée" class="cmdFinie" />
    </article>
  </section>
</body>

</html>